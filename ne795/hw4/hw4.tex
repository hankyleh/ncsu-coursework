\documentclass{template}
\title{NE 795 Assignment 4}
\author{Kyle Hansen}
\date{10 November 2025}

\usepackage{cancel}
\usepackage{empheq}
\newcommand*\multbox[1]{\fbox{\hspace{0ex}#1\hspace{0ex}}}






\begin{document}

\maketitle

\section{Differential Fourier Analysis}

\subsection{Iterative Error Equations}

Using the definitions of iterative error,

\begin{gather}
  \delta \psi^{(s+1/2)} = \psi^\star - \psi^{(s+1/2)}\\
  \delta F^{(s+1/2)} = F^\star - F^{(s+1/2)}\\
  \delta J^{(s+1)} = J^\star - J^{(s+1)}\\
  \delta \phi^{(s+1)} = \phi^\star - \phi^{(s+1)},
\end{gather}

The equations for iterative error of the transport equation can be found by subtracting the equation for the $(s+1/2)$ iterate from the equation for the true (converged) solution:


\begin{align}
  \mu\frac{d\psi^\star}{dx}  -   \mu\frac{d\psi^{(s+1/2)}}{dx}    + \sigma_t \psi^\star - \sigma_t \psi^{(s+1/2)} &= \frac{1}{2}\left( \sigma_s \phi^\star + q \right) - \frac{1}{2}\left( \sigma_s \phi^{(s)} + q \right)\\
  \mu\frac{d\delta\psi^{(s+1/2)}}{dx} + \sigma_t \delta\psi^{(s+1/2)} &= \frac{1}{2}\left( \sigma_s \delta\phi^{(s)} \right)
\end{align}

where 

\begin{align}
  \delta\psi^{(s+1/2)}(0, \mu) = (\psi_{in}^+ - \psi_{in}^+) =  0 & \quad\text{for }\mu > 0\\
  \delta\psi^{(s+1/2)}(X, \mu) = (\psi_{in}^- - \psi_{in}^-) =  0 & \quad\text{for }\mu < 0
\end{align}

and $^\star$ denotes the true (converged) solution. The equations for error in the closure terms are found in a similar way:

\begin{equation}
  \delta F^{(s+1/2)} = \int_{-1}^{1} \left(\frac{1}{3} - \mu^2 \right)\delta\psi^{(s+1/2)}d\mu
\end{equation}
\begin{subequations}
  \begin{gather}
    \delta P_L^{(s+1/2)} = \int_{-1}^{1} \left(  \frac{1}{2} - |\mu| \right)\delta\psi^{(s+1/2)}(0, \mu)d\mu\\
  \delta P_R^{(s+1/2)} = \int_{-1}^{1} \left(  \frac{1}{2} - |\mu| \right)\delta\psi^{(s+1/2)}(X, \mu)d\mu.
  \end{gather}
\end{subequations}

The equations for the errors in the SM equations are found the same way:

\begin{gather}
  \label{eq:flux-error-J-dependent}\frac{d \delta J^{(s+1)}}{dx} + \left(\sigma_t - \sigma_s\right)\delta\phi^{(s+1)} = 0\\
  \label{eq:J-error}\frac{1}{3}\frac{d\delta\phi^{(s+1)}}{dx} + \sigma_t\delta J^{(s+1)} = \frac{d \delta F^{(s+1/2)}}{dx}\\
  \label{eq:J0}\delta J^{(s+1)}(0) =  - \frac{1}{2}\delta\phi^{(s+1)}(0) + \delta P_L^{(s+1/2)}\\
  \label{eq:JX}\delta J^{(s+1)}(X) = \frac{1}{2}\delta\phi^{(s+1)}(X) - \delta P_R^{(s+1/2)}
\end{gather}

These equations resemble the original iterative equations, with source (and incoming flux boundary conditions) set to zero. By taking the derivative of \autoref{eq:J-error} with respect to x and plugging into equation \autoref{eq:flux-error-J-dependent}, these equations can be reduced to a single equation for $\delta\phi$ only:

\begin{align}
   \sigma_t\delta J^{(s+1)} &= \frac{d \delta F^{(s+1/2)}}{dx} - \frac{1}{3}\frac{d\delta\phi^{(s+1)}}{dx}\\
   \label{eq:J}\delta J^{(s+1)} &= \frac{1}{\sigma_t}\frac{d \delta F^{(s+1/2)}}{dx} - \frac{1}{3\sigma_t}\frac{d\delta\phi^{(s+1)}}{dx}\\
  \frac{d \delta J^{(s+1)}}{dx} &= \frac{1}{\sigma_t}\frac{d^2 \delta F^{(s+1/2)}}{dx^2} - \frac{1}{3\sigma_t}\frac{d^2 \delta\phi^{(s+1)}}{dx^2},
\end{align}

evaluating \autoref{eq:flux-error-J-dependent} using this equation for $(\delta J)_x$, 

\begin{align}
  \left(\sigma_t - \sigma_s\right)\delta\phi^{(s+1)} &+ \frac{d \delta J^{(s+1)}}{dx}  = 0\\
  \left(\sigma_t - \sigma_s\right)\delta\phi^{(s+1)} &+ \frac{1}{\sigma_t}\frac{d^2 \delta F^{(s+1/2)}}{dx^2} - \frac{1}{3\sigma_t}\frac{d^2 \delta\phi^{(s+1)}}{dx^2} =0.
\end{align}

The boundary conditions $J(0)$ and $J(X)$ can be used to formulate axiliary conditions for the equation for $\phi$. Evaluating \autoref{eq:J} using Equations~\ref{eq:J0} and~\ref{eq:JX} yields the auxiliary conditions:

\begin{subequations}
  \begin{align}
  \frac{1}{\sigma_t(0)} \left. \frac{d \delta F^{(s+1/2)}}{dx}\right\vert_{x=0} - \left. \frac{1}{3\sigma_t}\frac{d\delta\phi^{(s+1)}}{dx}\right\vert_{x=0} &= - \frac{1}{2}\delta\phi^{(s+1)}(0) + \delta P_L^{(s+1/2)}\\
  \frac{1}{\sigma_t(X)} \left. \frac{d \delta F^{(s+1/2)}}{dx}\right\vert_{x=X} - \left. \frac{1}{3\sigma_t}\frac{d\delta\phi^{(s+1)}}{dx}\right\vert_{x=X} &= - \frac{1}{2}\delta\phi^{(s+1)}(X) + \delta P_R^{(s+1/2)}
\end{align}
\end{subequations}


Then the full set of equations for iterative error for the SM iterative algorithm is:

\begin{subequations}\label{eq:error_equations}
  \begin{empheq}[box=\multbox]{gather}
    \mu\frac{d\delta\psi^{(s+1/2)}}{dx} + \sigma_t \delta\psi^{(s+1/2)} = \frac{1}{2}\left(\sigma_s \delta\phi^{(s)} \right)\\
    \delta\psi^{(s+1/2)}(0, \mu)  =  0  \quad\text{for }\mu > 0 \qquad \text{and} \qquad \delta\psi^{(s+1/2)}(X, \mu)  =  0  \quad\text{for }\mu < 0\\
    \delta F^{(s+1/2)} = \int_{-1}^{1} \left(\frac{1}{3} - \mu^2 \right)\delta\psi^{(s+1/2)}d\mu\\
  \delta P_L^{(s+1/2)} = \int_{-1}^{1} \left(  \frac{1}{2} - |\mu| \right)\delta\psi^{(s+1/2)}(0, \mu)d\mu\\
  \delta P_R^{(s+1/2)} = \int_{-1}^{1} \left(  \frac{1}{2} - |\mu| \right)\delta\psi^{(s+1/2)}(X, \mu)d\mu\\
  \left(\sigma_t - \sigma_s\right)\delta\phi^{(s+1)} + \frac{1}{\sigma_t}\frac{d^2 \delta F^{(s+1/2)}}{dx^2} - \frac{1}{3\sigma_t}\frac{d^2 \delta\phi^{(s+1)}}{dx^2} =0\\
  \frac{1}{\sigma_t(0)} \left. \frac{d \delta F^{(s+1/2)}}{dx}\right\vert_{x=0} - \left. \frac{1}{3\sigma_t}\frac{d\delta\phi^{(s+1)}}{dx}\right\vert_{x=0} = - \frac{1}{2}\delta\phi^{(s+1)}(0) + \delta P_L^{(s+1/2)}\\
  \frac{1}{\sigma_t(X)} \left. \frac{d \delta F^{(s+1/2)}}{dx}\right\vert_{x=X} - \left. \frac{1}{3\sigma_t}\frac{d\delta\phi^{(s+1)}}{dx}\right\vert_{x=X} = - \frac{1}{2}\delta\phi^{(s+1)}(X) + \delta P_R^{(s+1/2)}
  \end{empheq}
\end{subequations}

\subsection{Fourier Analysis}

Validity of Fourier analysis depends on the conditions:

\begin{itemize}
  \item Infinite spatial domain
  \item Constant coefficients in all equations ($\sigma_t(x) = \sigma_t$ and $\sigma_s(x) = \sigma_s$).
\end{itemize}

If these conditions are true, the Fourier Ansatz is used to formulate an assumed form of the solutions to the system defined in~\ref{eq:error_equations}:

\begin{subequations}
  \begin{gather}
    \delta \psi^{(s)} = \int_{-\infty}^{\infty} f^{(s)}(\lambda, \mu)e^{i\lambda\sigma_t x} d\lambda \\
    \delta F^{(s)} = \int_{-\infty}^{\infty} g^{(s)}(\lambda)e^{i\lambda \sigma_t x} d\lambda\\
    \delta \phi^{(s)} = \int_{-\infty}^{\infty} h^{(s)}(\lambda)e^{i\lambda\sigma_t x} d\lambda
  \end{gather}
\end{subequations}

where $\lambda$ is the Fourier mode wavenumber. Substituting the Fourier Ansatz into the system~\ref{eq:error_equations}:

\begin{subequations}
  \begin{gather}
    \sigma_t(i\mu \lambda + 1)f^{(s+1/2)}(\lambda, \mu) = \frac{\sigma_s}{2}h^{(s)}(\lambda)\\
    g^{(s+1/2)}(\lambda) = \int_{-1}^{1} \left(\frac{1}{3} - \mu^2 \right)f^{(s+1/2)}(\lambda, \mu)d\mu\\
    \left(\sigma_t - \sigma_s \right) h^{(s+1)}(\lambda) - {\lambda^2 \sigma_t}g^{(s+1/2)}(\lambda) + \frac{1 }{3} {\lambda^2\sigma_t}h^{(s+1)}(\lambda)=0
  \end{gather}
\end{subequations}

Solving these equations yields the expression:

\begin{equation}
  h^{(s+1)}(\lambda) = h^{(s)}(\lambda) \cdot \frac{\lambda^2}{1 - c + \frac{1}{3\sigma_t}\lambda^2}\int_{-1}^{1}\left(\frac{1}{3} - \mu^2 \right) \frac{c}{2(1+i\mu\lambda)}d\mu,
\end{equation}

where $c$ is the scattering ratio $\sigma_s/\sigma_t$. Then the iteration eigenvalue $\omega(\lambda)$ is

\begin{equation}
  \omega(\lambda) = \frac{\lambda^2}{1 - c + \frac{1}{3\sigma_t}\lambda^2}\left[\frac{c}{2}\int_{-1}^{1}\left(\frac{1}{3} - \mu^2 \right) \frac{1}{(1+i\mu\lambda)}d\mu\right]
\end{equation}

where the integral is equal to

\begin{equation}
\left[\frac{c}{2}\int_{-1}^{1}\left(\frac{1}{3} - \mu^2 \right) \frac{1}{(1+i\mu\lambda)}d\mu\right] =  \frac{\left(2\left(\lambda^2 + 3 \right)\tan^{-1}\lambda\right) - 6\lambda}{3\lambda^3}
\end{equation}



\subsection{Plots}
% TODO

\subsection{Spectral Radius}
% TODO


\section{Discretized Fourier Analysis}
\subsection{Iterative Error Equations}
Subtracting the $(s+1/2)$ transport iteration equation from the equation for the true solution $\psi^\star$ yields

\begin{multline}
  \mu_m\left(\psi_{m, i+1/2}^\star  - \psi_{m, i-1/2}^\star\right) - \mu_m\left(\psi_{m, i+1/2}^{(s+1/2)}  - \psi_{m, i-1/2}^{(s+1/2)}\right) + \sigma_{t, i}\Delta x_i (\psi_{m, i}^\star - \psi_{m, i}^{(s+1/2)}) =\\
   \frac{1}{2}\left(\sigma_{s, i}\phi_i^\star  - \sigma_{s, i}\phi_i^{(s)}+ \cancel{(q_i - q_i)}\right) \Delta x_i 
\end{multline}

\begin{equation}
  \mu_m\left(\delta\psi_{m, i+1/2}^{(s+1/2)}  - \delta\psi_{m, i-1/2}^{(s+1/2)}\right) + \sigma_{t, i}\Delta x_i (\delta\psi_{m, i}^{(s+1/2)}) =\frac{1}{2}\left(\sigma_{s, i}\delta\phi_i^{(s)}\right) \Delta x_i,
\end{equation}

with boundary conditions $\delta\psi^{(s+1/2)}_{m, 1/2} = 0$ for $\mu_m > 0$ and $\delta\psi^{(s+1/2)}_{m, N+1/2} = 0$ for $\mu_m < 0$. The error in scalar flux is

\begin{equation}
  \delta\phi_{i+1/2}^{(s)} = \sum_{m=1}^{M} \delta\psi_{m, i+1/2}^{(s)}  w_m,
\end{equation}

and the SC cell-center values are

\begin{gather}
  \psi_{m, i}^\star - \psi_{m, i}^{(s+1/2)} = \alpha_{m, i}\left( \psi_{m,i-1/2}^\star - \psi_{m,i-1/2}^{(s+1/2)} \right) + (1-\alpha_{m, i})\left( \psi_{m,i+1/2}^\star - \psi_{m,i+1/2}^{(s+1/2)} \right)\\
  \delta\psi_{m, i}^{(s+1/2)} = \alpha_{m, i}\left( \delta \psi_{m,i-1/2}^{(s+1/2)} \right) + (1-\alpha_{m, i})\left( \delta\psi_{m,i+1/2}^{(s+1/2)} \right).
\end{gather}

The error in the second-moment closure term is

\begin{gather}
  \delta F_i^{(s+1/2)} = \sum_{m=1}^{M}\left(\frac{1}{3} - \mu_m^2 \right) \delta \psi_{m, i}^{(s+1/2)} w_m\\
  \delta F_{i+1/2}^{(s+1/2)} = \sum_{m=1}^{M}\left(\frac{1}{3} - \mu_m^2 \right) \delta \psi_{m, i+1/2}^{(s+1/2)} w_m,
\end{gather}

and the error in $d_i$ is

\begin{gather}
  \delta d_i^{(s+1/2)} = \frac{1}{\sigma_{t, i-1/2}\Delta x_{i-1/2}} \left(F_i^\star - F_i^{(s+1/2)} - F_{i-1}^\star + F_{i-1}^{(s+1/2)}\right)\\
  \delta d_i^{(s+1/2)} = \frac{1}{\sigma_{t, i-1/2}\Delta x_{i-1/2}} \left(\delta  F_i^{(s+1/2)} - \delta F_{i-1}^{(s+1/2)}\right).
\end{gather}

The boundary term error is

\begin{gather}
  \delta P_L = \sum_{m=1}^{M} \left(\frac{1}{2} - |\mu_m| \right)\delta\psi_{m, 1/2}^{(s+1/2)} w_m\\
  \delta P_R = \sum_{m=1}^{M} \left(\frac{1}{2} - |\mu_m| \right)\delta\psi_{m, N+1/2}^{(s+1/2)} w_m.
\end{gather}

The error in the SM equation is given by

\begin{multline}
  -a_i (\delta\phi_{i-1}^{(s+1)}) + (a_{i+1} + a_i + (\sigma_{a, i})\Delta x_i)\delta\phi_i^{(s+1)} - a_{i+1}\delta\phi_{i+1}^{(s+1)} \\
  = \delta d_i^{(s+1/2)} - \delta d_{i+1}^{(s+1/2)} + \Delta x_i \cancel{q_i - q_i},
\end{multline}

where $\sigma_{a, i} = \sigma_{t, i} - \sigma_{s, i}$. The errors for the boundary conditions are given by

\begin{subequations}
  \begin{gather}
  \left( \frac{1}{2} + a_1 \right)\delta\phi_0^{(s+1)} - a_1 \delta\phi_1^{(s+1)} = \delta P_L^{(s+1/2)} - \delta d_1^{(s+1/2)} + \cancel{2J_{in}^+ - 2J_{in}^+}\\
  \left( \frac{1}{2} + a_{N+1} \right)\delta\phi_{N+1}^{(s+1)} - a_{N+1} \delta\phi_{N+1}^{(s+1)} = \delta P_R^{(s+1/2)} + \delta d_{N+1}^{(s+1/2)} - \cancel{2J_{in}^- + 2J_{in}^-}.
\end{gather}
\end{subequations}


Then the full set of equations for iterative error for the discretized SM Method is

\begin{subequations}\label{eq:disc_error_eqns}
  \begin{empheq}[box=\multbox]{gather}
    \mu_m\left(\delta\psi_{m, i+1/2}^{(s+1/2)}  - \delta\psi_{m, i-1/2}^{(s+1/2)}\right) + \sigma_{t, i}\Delta x_i (\delta\psi_{m, i}^{(s+1/2)}) =\frac{1}{2}\left(\sigma_{s, i}\delta\phi_i^{(s)}\right) \Delta x_i\\
    \delta\psi^{(s+1/2)}_{m, 1/2} = 0 \text{ for }\mu_m > 0, \qquad \delta\psi^{(s+1/2)}_{m, N+1/2} = 0 \text{ for }\mu_m < 0\\
    \delta\psi_{m, i}^{(s+1/2)} = \alpha_{m, i}\left( \delta \psi_{m,i-1/2}^{(s+1/2)} \right) + (1-\alpha_{m, i})\left( \delta\psi_{m,i+1/2}^{(s+1/2)} \right)\\
    % \delta F_i^{(s+1/2)} = \sum_{m=1}^{M}\left(\frac{1}{3} - \mu_m^2 \right) \delta \psi_{m, i}^{(s+1/2)} w_m, \; \delta F_{i+1/2}^{(s+1/2)} = \sum_{m=1}^{M}\left(\frac{1}{3} - \mu_m^2 \right) \delta \psi_{m, i+1/2}^{(s+1/2)} w_m\\
    \delta d_i^{(s+1/2)} = \frac{1}{\sigma_{t, i-1/2}\Delta x_{i-1/2}} \left[\sum_{m=1}^{M}\left(\frac{1}{3} - \mu_m^2 \right) \left(\delta \psi_{m, i}^{(s+1/2)} - \delta \psi_{m, i-1}^{(s+1/2)} \right) w_m\right]\\
    \delta P_L = \sum_{m=1}^{M} \left(\frac{1}{2} - |\mu_m| \right)\delta\psi_{m, 1/2}^{(s+1/2)} w_m\\
    \delta P_R = \sum_{m=1}^{M} \left(\frac{1}{2} - |\mu_m| \right)\delta\psi_{m, N+1/2}^{(s+1/2)} w_m\\
    -a_i (\delta\phi_{i-1}^{(s+1)}) + (a_{i+1} + a_i + (\sigma_{a, i})\Delta x_i)\delta\phi_i^{(s+1)} - a_{i+1}\delta\phi_{i+1}^{(s+1)}= \delta d_i^{(s+1/2)} - \delta d_{i+1}^{(s+1/2)}\\
    \left( \frac{1}{2} + a_1 \right)\delta\phi_0^{(s+1)} - a_1 \delta\phi_1^{(s+1)} = \delta P_L^{(s+1/2)} - \delta d_1^{(s+1/2)} \\
  \left( \frac{1}{2} + a_{N+1} \right)\delta\phi_{N+1}^{(s+1)} - a_{N+1} \delta\phi_{N+1}^{(s+1)} = \delta P_R^{(s+1/2)} + \delta d_{N+1}^{(s+1/2)} 
  \end{empheq}
\end{subequations}

where
\begin{gather}
  a_i = \frac{1}{3\sigma_{t, i-1/2}\Delta x_{i-1/2}}\\
  \phi_0 = \phi_{1/2}, \qquad \phi_{N+1} = \phi_{N+1/2}\\
  \psi_{m, 0} = \psi_{m, 1/2}, \qquad \psi_{m, N+1} = \psi_{m, N+1/2}.
\end{gather}


\subsection{Fourier Analysis}

Like the continuous form of the SM method, Fourier Analysis of the discretized form requires that these assumptions are satisfied:

\begin{itemize}
  \item Infinite spatial domain
  \item Constant coefficients $\sigma_a, \sigma_t, \theta, \tau$
  \item Uniform spatial grid $\Delta x$
\end{itemize}

Then, using the Fourier Ansatz, the assumed form of the errors are

\begin{gather}
  \delta\psi_{m, i+1/2}^{(s+1/2)} =\int_{-\infty}^{\infty} f_m^{(s+1/2)}(\lambda)e^{i\sigma_t \lambda x_{i+1/2}} d\lambda\\
  \delta\psi_{m, i}^{(s+1/2)} =\int_{-\infty}^{\infty} \Psi_m^{(s+1/2)}(\lambda)e^{i\sigma_t \lambda x_{i}} d\lambda\\
  \delta d_{i}^{(s+1/2)} =\int_{-\infty}^{\infty} g^{(s+1/2)}(\lambda)e^{i\sigma_t \lambda x_{i}} d\lambda\\
  \delta\phi_{i}^{(s+1)} =\int_{-\infty}^{\infty} h^{(s)}(\lambda)e^{i\sigma_t \lambda x_{i}} d\lambda\\
\end{gather}

where $f_m(\lambda)$ denotes $f(\lambda, \mu_m)$. Substituting these into the system~\ref{eq:disc_error_eqns} yields the system to find $\omega(\lambda) = h^{(s+1)}/h^{(s)}$. First, some common terms can be simplified:

\begin{align}
\delta\psi_{m, i+1/2}^{(s+1/2)} - \delta\psi_{m, i-1/2}^{(s+1/2)} &= f_m^{(s+1/2)}\left[e^{i\lambda\sigma_t x_{i+1/2}} - e^{i\lambda\sigma_t x_{i-1/2}}\right] \\
&= f_m^{(s+1/2)}\left[e^{i\lambda\sigma_t (x_{i}+\frac{1}{2}\Delta x)} - e^{i\lambda\sigma_t (x_{i}-\frac{1}{2}\Delta x)}\right]\\
&= f_m^{(s+1/2)}e^{i\lambda\sigma_t x_{i}}\left[e^{\frac{1}{2}i\lambda\sigma_t \Delta x} - e^{-\frac{1}{2}i\lambda\sigma_t \Delta x}\right]
\end{align}

then


\begin{multline}
  \delta\psi_{m, i+1/2}^{(s+1/2)} - \delta\psi_{m, i-1/2}^{(s+1/2)} =f_m^{(s+1/2)}e^{i\lambda\sigma_t x_{i}}\left[\cos\left(\frac{1}{2}\lambda\sigma_t \Delta x\right) + i\sin\left(\frac{1}{2}\lambda\sigma_t \Delta x\right)\right.\\
  - \left.\cos\left(-\frac{1}{2}\lambda\sigma_t \Delta x\right) - i\sin\left(-\frac{1}{2}\lambda\sigma_t \Delta x\right)\right].
\end{multline}
Since $\cos(-\theta) = \cos(\theta)$ and $\sin(-\theta) = -\sin(\theta)$, 

\begin{equation}
  \delta\psi_{m, i+1/2}^{(s+1/2)} - \delta\psi_{m, i-1/2}^{(s+1/2)} =f_m^{(s+1/2)}e^{i\lambda\sigma_t x_{i}}\left[2i\sin\left(\frac{1}{2}\lambda\sigma_t \Delta x\right)\right].
\end{equation}



\subsection{Plots}
% TODO

\subsection{Spectral Radius}
% TODO



\end{document}
